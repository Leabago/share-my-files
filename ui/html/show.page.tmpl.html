{{template "base" .}}
{{define "title"}}Snippet{{end}}
{{define "main"}}

{{with .File}}
<div class="container">

    {{if not .Exist}}
    <div class="row">
        <div class="col" align="center">
            <h2>File with code {{.FileCode}} does not exist.</h2>
        </div>
    </div>
    {{else}}
    <div class="row">
        <div class="col">
            <h1>File code: <strong>{{.FileCode}}</strong></h1>
            <h4>list of files:</h4>
            <ul class="ul">
                {{ range .FileNameList }}
                <li>{{ . }}</li>
                {{ end }}
            </ul>
        </div>

        <div class="col-8" >
            <br>

            {{if .OneDownload}}
            <input type="button" id="oneDownloadInput" class="btn btn-success" value="One download"
                onclick="location.href='/archive/download/{{.FileCode}}';document.getElementById('oneDownloadInput').disabled=true;" />
            {{else}}
            <input type="button" id="oneDownloadInput" class="btn btn-success" value="Download"
                onclick="location.href='/archive/download/{{.FileCode}}';" />
            {{ end }}

        
            <br>
            <div>
                <input type="url" value={{.URL}} id="myInput" readonly>

                <div id="tooltip">
                    <!-- <button onclick="copyToClipboard()" onmouseout="outFunc()"> -->
                    <input type="button" class="btn btn-success" value="Copy text" onclick="copyToClipboard_1()">

                    <button onClick="buttonPress()">‚û°Ô∏è Copy Message to Clipboard</button>

                </div>
            </div>
            <br>
            <img src="data:image/png;base64,{{.QRcodeBase64}}" />
        </div>
    </div>
    {{ end }}
</div>
{{end}}


<script type="text/javascript"> const buttonPress = () => { copyToClipboard(document.getElementById("myInput").value); console.log('Clipboard updated üì•\nNow try pasting!'); };


    <!-- <script> -->

    const unsecuredCopyToClipboard = (text) => { const textArea = document.createElement("textarea"); textArea.value = text; document.body.appendChild(textArea); textArea.focus(); textArea.select(); try { document.execCommand('copy') } catch (err) { console.error('Unable to copy to clipboard', err) } document.body.removeChild(textArea) };

    /**
     * Copies the text passed as param to the system clipboard
     * Check if using HTTPS and navigator.clipboard is available
     * Then uses standard clipboard API, otherwise uses fallback
    */
    const copyToClipboard = (content) => {
        if (window.isSecureContext && navigator.clipboard) {
            navigator.clipboard.writeText(content);
        } else {
            unsecuredCopyToClipboard(content);
        }
    };


    function copyToClipboard_1() {
        // Get the text field
        var linkToFile = document.getElementById("myInput").value;

        navigator.clipboard.writeText(linkToFile)
            .then(() => {
                console.log('Text copied to clipboard:', linkToFile);
                alert('Text copied to clipboard!');
            })
            .catch((err) => {
                console.error('Failed to copy text:', err);
                alert('Failed to copy text to clipboard.');
            });
    }

    // function outFunc() {
    //     var tooltip = document.getElementById("myTooltip");
    //     tooltip.innerHTML = "Copy to clipboard";
    // }
</script>
{{end}}